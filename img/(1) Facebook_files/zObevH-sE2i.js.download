if (self.CavalryLogger) { CavalryLogger.start_js(["QWjnm"]); }

__d("PhotoInpaintingCanvas.react",["ix","cssVar","cx","DOM","DOMContainer.react","DOMDimensions","Event","Image.react","immutable","PhotoInpaintingActions","React","Vector","asset","ge","nullthrows","uuid"],(function a(b,c,d,e,f,g,h,i,j){"use strict";var k,l,m=c("React").PureComponent,n=function n(u){var v=u.enableUndoButton?u.onClick:function(x){},w=u.enableUndoButton?h("396732"):h("396731");return c("React").createElement("div",{className:(u.enableUndoButton?"_4jll":"")+" _4jlm",onClick:v},c("React").createElement("div",{className:"_4jln"},c("React").createElement("svg",{className:"_4jlo",height:"32",width:"32"},c("React").createElement("circle",{cx:"16",cy:"16",fill:"#000000",opacity:"0.75",r:"16"})),c("React").createElement(c("Image.react"),{className:"_4jlp",src:w})))},o=function o(u,v,w){var x=c("nullthrows")(u.getContext&&u.getContext("2d"));x.globalAlpha=.6;x.fillStyle=w;x.fillRect(v.pointOne.x,v.pointOne.y,v.pointTwo.x-v.pointOne.x,v.pointTwo.y-v.pointOne.y);x.stroke();x.globalAlpha=1},p=function p(u,v,w){o(u,v,w);var x=c("nullthrows")(u.getContext&&u.getContext("2d"));x.strokeStyle=w;x.lineWidth="2";x.strokeRect(v.pointOne.x,v.pointOne.y,v.pointTwo.x-v.pointOne.x,v.pointTwo.y-v.pointOne.y);x.stroke()},q=function q(u){if(!u.enable)return null;var v=c("DOM").create("canvas",{height:u.renderedImageHeight,width:u.renderedImageWidth});o(v,{pointOne:{x:0,y:0},pointTwo:{x:u.renderedImageWidth,y:u.renderedImageHeight}},"#000000");return c("React").createElement("div",{className:"_63an _63ao"},c("React").createElement(c("DOMContainer.react"),null,v))},r=function r(u){var v=c("DOM").create("canvas",{height:u.renderedImageHeight,width:u.renderedImageWidth});u.boundingBoxes.forEach(function(w){p(v,w,"#FA3E3E")});return c("React").createElement("div",{className:"_63an _63ao"},c("React").createElement(c("DOMContainer.react"),null,v))},s=function s(u){if(!u.enableDrawingBoxes)return null;var v=c("DOM").create("canvas",{height:u.renderedImageHeight,width:u.renderedImageWidth}),w=false,x={x:-1,y:-1};c("Event").listen(v,"mousedown",function(event){w=true;event.preventDefault();var z=c("Vector").getEventPosition(event).sub(c("Vector").getElementPosition(v));x={x:z.x,y:z.y}});c("Event").listen(v,"mousemove",function(event){if(w){event.preventDefault();var z=c("Vector").getEventPosition(event).sub(c("Vector").getElementPosition(v)),A=c("nullthrows")(v.getContext&&v.getContext("2d"));A.clearRect(0,0,u.renderedImageWidth,u.renderedImageHeight);p(v,{pointOne:x,pointTwo:{x:z.x,y:z.y}},"#FA3E3E")}});var y=function y(event){if(w){w=false;event.preventDefault();event.stopPropagation();var z=c("Vector").getEventPosition(event).sub(c("Vector").getElementPosition(v));if(x.x!==-1&&x.y!==-1)u.onBoundingBoxCommit({pointOne:x,pointTwo:{x:Math.min(z.x,u.renderedImageWidth),y:Math.min(z.y,u.renderedImageHeight)}});var A=c("nullthrows")(v.getContext&&v.getContext("2d"));A.clearRect(0,0,u.renderedImageWidth,u.renderedImageHeight);x={x:-1,y:-1}}};c("Event").listen(v,"mouseup",function(event){y(event)});u.mouseUpNotifier(function(event){y(event)});return c("React").createElement("div",{className:"_63an _63ap"},c("React").createElement(c("DOMContainer.react"),null,v))};k=babelHelpers.inherits(t,m);l=k&&k.prototype;function t(u){l.constructor.call(this,u);this.$PhotoInpaintingCanvas1=c("uuid")();this.$PhotoInpaintingCanvas2=function(){var v=c("ge")(this.$PhotoInpaintingCanvas1),w=c("DOMDimensions").getElementDimensions(v);this.setState({renderedImageHeight:w.height,renderedImageWidth:w.width});this.props.onImageDimensionsSet(w.height,w.width)}.bind(this);this.state={renderedImageHeight:-1,renderedImageWidth:-1}}t.prototype.$PhotoInpaintingCanvas3=function(u){c("PhotoInpaintingActions").addBoundingBox(u)};t.prototype.$PhotoInpaintingCanvas4=function(event){c("PhotoInpaintingActions").undoInpainting()};t.prototype.render=function(){return c("React").createElement("div",{className:"_63aq"},c("React").createElement(n,{enableUndoButton:this.props.enableUndoButton,onClick:this.$PhotoInpaintingCanvas4}),c("React").createElement(c("Image.react"),{id:this.$PhotoInpaintingCanvas1,onLoad:this.$PhotoInpaintingCanvas2,src:this.props.imageURI.toString(),width:this.props.width}),c("React").createElement(r,{boundingBoxes:this.props.boundingBoxes,renderedImageHeight:this.state.renderedImageHeight,renderedImageWidth:this.state.renderedImageWidth}),c("React").createElement(s,{enableDrawingBoxes:this.props.enableDrawingBoxes,mouseUpNotifier:this.props.mouseUpNotifier,onBoundingBoxCommit:this.$PhotoInpaintingCanvas3,renderedImageHeight:this.state.renderedImageHeight,renderedImageWidth:this.state.renderedImageWidth}),c("React").createElement(q,{enable:this.props.enableDarkenMask,renderedImageHeight:this.state.renderedImageHeight,renderedImageWidth:this.state.renderedImageWidth}))};f.exports=t}),null);